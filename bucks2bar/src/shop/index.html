<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bucks2Bar Shop</title>
  <link rel="stylesheet" href="./css/shop.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow sticky-top">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold" href="#">Bucks2Bar</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item"><a class="nav-link active" href="#heroCarousel">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="#offerProducts">Offers</a></li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">Categories</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Coffee</a></li>
              <li><a class="dropdown-item" href="#">Beverages</a></li>
              <li><a class="dropdown-item" href="#">Snacks</a></li>
            </ul>
          </li>
        </ul>

        <!-- Login dropdown -->
        <div class="dropdown">
          <button class="btn btn-outline-light dropdown-toggle" type="button" data-bs-toggle="dropdown">
            Login
          </button>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="#" onclick="setLoginMode('user')">Login as User</a></li>
            <li><a class="dropdown-item" href="#" onclick="setLoginMode('admin')">Login as Admin</a></li>
          </ul>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Carousel -->
  <div id="heroCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
    <div class="carousel-inner">
      <div class="carousel-item active">
        <img src="https://t4.ftcdn.net/jpg/03/26/12/23/360_F_326122335_RKvTXMb4RYkIzk94ZoPjkZQe2CUOVnen.jpg" class="d-block w-100" alt="Coffee Banner">
      </div>
      <div class="carousel-item">
        <img src="https://img.freepik.com/premium-vector/refreshing-soft-drink-banner-with-frozen-hand-holding-beverage_317442-644.jpg" class="d-block w-100" alt="Beverage Banner">
      </div>
      <div class="carousel-item">
        <img src="https://as1.ftcdn.net/jpg/03/68/66/94/1000_F_368669476_Cl7gGRuBWRYnPLwwY8pBgmeH1lGvpQ1r.jpg" class="d-block w-100" alt="Snacks Banner">
      </div>
    </div>
  </div>

  <!-- Offers Section -->
  <section class="container my-5">
    <h2 class="mb-4 fw-bold">ðŸ”¥ Todayâ€™s Deals</h2>
    <div id="offerProducts" class="row g-4"></div>
  </section>

  <!-- All Products Section -->
  <section id="shopSection" class="container my-5" style="display:none;">
    <h2 class="mb-4 fw-bold text-center">âœ¨ All Products</h2>
    <div id="productList" class="row g-4"></div>
  </section>

  <!-- Login Section -->
  <section id="loginSection" class="container my-5" style="display:none;">
    <h2 id="loginTitle" class="text-center mb-4">Login</h2>
    <div class="card p-4 shadow-sm">
      <input type="text" id="username" class="form-control mb-3" placeholder="Username">
      <input type="password" id="password" class="form-control mb-3" placeholder="Password">
      <button id="loginBtn" class="btn btn-primary w-100">Login</button>
      <p id="loginMsg" class="text-danger text-center mt-2"></p>
    </div>
  </section>

  <!-- Admin Section -->
  <section id="adminSection" class="container my-5" style="display:none;">
    <h2 class="mb-4 text-center">Admin Dashboard</h2>
    <div id="adminProductList" class="row g-4"></div>
  </section>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="./js/shop.js"></script>
  <script>
    // Initialize login dropdown and button logic (works with existing shop.js)
    function setLoginMode(mode) {
      const loginSection = document.getElementById('loginSection');
      const shopSection = document.getElementById('shopSection');
      const adminSection = document.getElementById('adminSection');
      const loginTitle = document.getElementById('loginTitle');
      const loginMsg = document.getElementById('loginMsg');

      loginTitle.textContent = mode === "admin" ? "Admin Login" : "User Login";
      loginSection.style.display = 'block';
      shopSection.style.display = 'none';
      adminSection.style.display = 'none';
      loginMsg.textContent = '';

      document.getElementById('loginBtn').onclick = () => {
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value;

        if (mode === "admin") {
          if (username === "admin" && password === "admin123") {
            loginSection.style.display = 'none';
            adminSection.style.display = 'block';
            loadAdminProducts();
          } else {
            loginMsg.textContent = "Invalid Admin credentials!";
          }
        } else {
          if ((username === "user1" && password === "password1") || (username === "user2" && password === "password2")) {
            loginSection.style.display = 'none';
            shopSection.style.display = 'block';
            loadProducts();
            loadOfferProducts(); // Load offer products for Flipkart-style homepage
          } else {
            loginMsg.textContent = "Invalid User credentials!";
          }
        }
      };
    }

    // Extra function for homepage offers (approved products only)
    async function loadOfferProducts() {
      try {
        const res = await fetch('products.json');
        const products = await res.json();
        const offerProducts = document.getElementById('offerProducts');
        offerProducts.innerHTML = '';

        products.filter(p => p.approved).forEach(product => {
          const div = document.createElement('div');
          div.className = 'col-md-3';
          div.innerHTML = `
            <div class="card position-relative p-2 shadow-sm h-100">
              <img src="https://source.unsplash.com/400x300/?coffee,drink,${product.name}" class="card-img-top" alt="${product.name}">
              <div class="card-body">
                <h5 class="card-title">${product.name}</h5>
                <p class="card-text">${product.description}</p>
                <p class="price">$${product.price.toFixed(2)}</p>
                <button class="btn btn-success w-100" onclick="purchase(${product.id})">Buy Now</button>
                <span class="offer-badge">HOT</span>
              </div>
            </div>
          `;
          offerProducts.appendChild(div);
        });
      } catch (err) {
        console.error(err);
      }
    }
  </script>
</body>
</html>
